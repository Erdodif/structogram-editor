@import "../variables";
@import "../mixins";

@mixin if_indicator_false($content: " ") {
    @include render_pseudo($content);
    @include icon_background(calc(100% - $border_width * 3 + 0.075em));
    background-image: $icon_diagonal_line;
    top: math.div(-$border_width, 2);
    bottom: 0;
    margin-block-start: -0.025em;
    padding-block-start: 0.925em;
    padding-inline-end: 0.5ch;
    display: block;
    width: 3.5ch;
    text-align: right;
    right: 0%;
    left: unset;
}

@mixin if_indicator_true($content: " ") {
    @include if_indicator_false($content);
    transform: scaleX(-1);
    left: 0%;
    right: unset;
}

@mixin statement_if {
    width: calc(100% + $border_width * 2);
    position: relative;
    max-width: unset;
    display: grid;
    grid-template-rows: auto auto;
    grid-template-areas: "head" "body";
    & > .content{
        &::before {
            z-index: 10;
            @include if_indicator_true("I");
        }
        &::after {
            @include if_indicator_false("H");
        }
        &> .editable {
        grid-area: head;
        border-block-end: $border;
    }

    }
    & > .statement-blocks {
        grid-area: body;
        display: grid;
        grid-template-rows: 1fr;
        grid-template-areas: "true false";
        justify-items: stretch;
        align-items: stretch;
        margin-block-end: $border_width;
        & > .if-false,
        > .if-true {
            height: 100%;
            display: flex;
            flex-direction: column;
            flex-wrap: nowrap;
            align-items: stretch;
            align-content: stretch;
            justify-content: flex-start;
            & > .statement {
                height: calc(100% + $border_width * 5);
            }
            & > .statement:last-child {
                margin-block-end: calc($border_width * -2);
            }
        }

        & > .if-true {
            grid-area: true;
        }
        & > .if-false {
            margin-inline-end: calc($border_width * -1);
            grid-area: false;
            & > .statement {
                margin-inline-start: 0;
                width: 100%;
            }
        }
    }
}

@mixin statement_switch {
    max-width: unset;
    & > .case-blocks {
        width: 100%;
        height: 100%;
        display: flex;
        flex-direction: row;
        flex-wrap: nowrap;
        justify-content: stretch;
        & > .case {
            &:hover {
                background: $color_statement_bg_highlight;
            }
            margin-block-end: -$border_width;
            &:last-child {
                margin-inline-end: -$border_width;
            }
            min-width: $statement_min_width;
            width: calc(100% + $border_width * 2);
            display: grid;
            grid-template-columns: 1fr;
            grid-template-rows: max-content auto;
            grid-template-areas: "case" "statements";
            align-self: stretch;
            & > .switch-else,
            & > .switch-case {
                margin-block-start: -$border_width;
                margin-inline-start: -$border_width;
                border: $border;
                grid-area: case;
            }
            /* & > .switch-case::before {
                    @include if_indicator_true;
                }*/
            & > .switch-else {
                color: transparent;
                user-select: none;
                /* &::before {
                        color: $color_statement_text;
                        @include if_indicator_false("H");
                    }*/
            }
            & > .switch-statements {
                grid-area: statements;
                background: crimson;
                margin-inline-end: $border_width;
                display: flex;                
                min-height: 100%;
                flex-direction: column;
                flex-wrap: nowrap;
                align-items: stretch;
                margin-block-end: -$border_width;
                
                & > :last-child {
                    margin-block-end: $border_width;
                }
                & > .statement{
                    height: 100%;
                }
            }
        }
    }
}
